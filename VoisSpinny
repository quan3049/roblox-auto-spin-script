local RS = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local SpinRemote = RS:WaitForChild("Network"):WaitForChild("Spinny Wheel: Request Spin")
local player = Players.LocalPlayer
local spinning = true
local Wheels = {"VoidWheel"}

-- Tạo GUI nhỏ gọn
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.ResetOnSpawn = false

local btn = Instance.new("TextButton")
btn.Parent = gui
btn.Size = UDim2.new(0, 100, 0, 36)
btn.Position = UDim2.new(1, -110, 1, -50) -- Góc dưới phải
btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
btn.TextColor3 = Color3.fromRGB(255, 255, 255)
btn.Font = Enum.Font.GothamBold
btn.TextSize = 16
btn.Text = " Auto: ON"
btn.AutoButtonColor = false
btn.BorderSizePixel = 0
btn.BackgroundTransparency = 0.1
btn.ClipsDescendants = true
btn.TextWrapped = true
btn.TextStrokeTransparency = 0.5
btn.ZIndex = 10
btn.AnchorPoint = Vector2.new(0, 0)

-- Làm bo góc
local UICorner = Instance.new("UICorner", btn)
UICorner.CornerRadius = UDim.new(0, 8)

btn.MouseButton1Click:Connect(function()
    spinning = not spinning
    btn.Text = spinning and " Auto: ON" or " Auto: OFF"
    btn.BackgroundColor3 = spinning and Color3.fromRGB(40, 40, 40) or Color3.fromRGB(120, 0, 0)
end)

-- ************************************
-- PHẦN MÃ MỚI: Xóa UI Vòng Quay
-- ************************************

local function destroyWheelUI()
    local playerGui = player:FindFirstChild("PlayerGui")
    if not playerGui then return end

    -- Danh sách các tên phổ biến mà UI vòng quay có thể sử dụng (thường là ScreenGui hoặc Frame)
    local potentialUI_Names = {
        "SpinnyWheelUI",  -- Tên chung
        "VoidWheelFrame", -- UI cụ thể của Void Wheel
        "WheelGUI",
        "RewardPopup",    -- Màn hình hiện thưởng
        "ScreenGui"       -- Có thể là tên mặc định nếu dev lười đặt tên
    }

    -- Lặp qua các tên tiềm năng để tìm và xóa
    for _, name in ipairs(potentialUI_Names) do
        -- Tìm kiếm đệ quy (true) để tìm trong các thư mục con
        local ui = playerGui:FindFirstChild(name, true) 
        
        -- Đảm bảo đây là một phần tử UI có thể xóa (ScreenGui, Frame, TextLabel, ImageLabel, ...)
        if ui and (ui:IsA("ScreenGui") or ui:IsA("Frame") or ui:IsA("ImageLabel") or ui:IsA("TextLabel")) then
            ui:Destroy()
            -- print("Đã xóa UI:", name) -- Bỏ comment nếu muốn debug
        end
    end
end

-- Quay vòng
task.spawn(function()
    while true do
        if spinning then
            for _, Wheel in ipairs(Wheels) do
                pcall(function()
                    -- Gửi yêu cầu quay vòng lên Server
                    SpinRemote:InvokeServer(Wheel)
                end)
                
                -- GỌI HÀM XÓA UI NGAY LẬP TỨC SAU KHI GỬI LỆNH QUAY
                destroyWheelUI() 
                
                task.wait(0.05) -- Độ trễ giữa các lần quay
            end
        end
        
        -- Gọi lại hàm xóa UI ở cuối vòng lặp chính để đảm bảo không có UI nào bị sót
        destroyWheelUI()

        task.wait(0.05) -- Độ trễ của vòng lặp chính
    end
end)
